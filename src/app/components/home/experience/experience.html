<section #experienceSection class="relative z-10">

  <!-- Horizontal Scroll Container -->
  <div #horizontalContainer class="relative overflow-hidden">
    <!-- Section Header -->
    <div class="max-w-5xl mx-auto px-4 pt-20 sm:px-6 lg:px-8" appScrollAnimation="fade-up">
      <div class="mb-8 text-center">
        <div class="text-center space-y-4">
          <div
            class="inline-flex items-center gap-2 text-lg font-mono text-zinc-600 dark:text-zinc-400"
          >
            <span class="w-8 h-px bg-zinc-300 dark:bg-zinc-700"></span>
            <span> Experience </span>
            <span class="w-8 h-px bg-zinc-300 dark:bg-zinc-700"></span>
          </div>
        </div>
      </div>
    </div>

    <!-- Background decorative elements -->
    <div
      class="absolute top-20 left-0 w-[500px] h-[500px] bg-[#fc413e]/5 dark:bg-[#fc413e]/3 blur-[100px] rounded-full -z-10 pointer-events-none"
    ></div>
    <div
      class="absolute bottom-0 right-1/2 w-[400px] h-[400px] bg-[#fc413e]/5 dark:bg-[#fc413e]/3 blur-[80px] rounded-full -z-10 pointer-events-none"
    ></div>

    <!-- Horizontal scroll track -->
    <div #horizontalTrack class="flex gap-8 px-8 py-16 will-change-transform">
      @for (item of experience(); track $index; let isFirst = $first; let isLast = $last) {
        <div class="group relative h-full w-[85vw] md:w-[500px] lg:w-[550px] flex-shrink-0">
          <!-- Card Background with Glassmorphism -->
          <div 
            class="absolute inset-0 bg-white/50 dark:bg-zinc-900/50 backdrop-blur-xl rounded-3xl border shadow-xl transition-all duration-500 group-hover:scale-[1.02] group-hover:shadow-2xl"
            [class.border-green-500/20]="item.current"
            [class.border-zinc-200]="!item.current"
            [class.dark:border-green-500/10]="item.current"
            [class.dark:border-zinc-800]="!item.current"
            [class.group-hover:border-green-500/30]="item.current"
            [class.group-hover:border-blue-500/30]="!item.current"
          ></div>

          <!-- Current/Previous Ambient Glow -->
          @if (item.current) {
            <div class="absolute inset-0 bg-green-500/5 dark:bg-green-500/10 rounded-3xl opacity-50 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none"></div>
            <div class="absolute -top-10 -right-10 w-40 h-40 bg-green-500/20 rounded-full blur-[60px] group-hover:bg-green-500/30 transition-colors duration-500 pointer-events-none"></div>
          } @else {
             <div class="absolute inset-0 bg-blue-500/0 dark:bg-blue-500/5 rounded-3xl opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none"></div>
             <div class="absolute -bottom-10 -left-10 w-40 h-40 bg-blue-500/20 rounded-full blur-[60px] opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none"></div>
          }

          <!-- Content Container -->
          <div class="relative h-full p-8 flex flex-col z-10">
            <!-- Header: Role, Company, Date -->
            <div class="flex justify-between items-start mb-8">
              <div class="flex flex-col gap-2">
                 <h3 class="text-2xl sm:text-3xl font-bold text-zinc-800 dark:text-zinc-100 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">
                    {{ item.title }}
                 </h3>
                 <div class="flex items-center gap-3 text-zinc-600 dark:text-zinc-400 font-medium">
                    <span class="p-1.5 rounded-lg bg-zinc-100 dark:bg-zinc-800/80 text-zinc-500 dark:text-zinc-400 group-hover:text-blue-500 dark:group-hover:text-blue-400 transition-colors">
                      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-1 4v2Z"/><path d="M21 21c-3 0-7-1-7-8V5c0-1.25.756-2.017 2-2h4c1.25 0 2 .75 2 1.972V11c0 1.25-.75 2-2 2-1 0-1 0-1 1v1c0 1 1 2 1 4v2Z"/></svg>
                    </span>
                    <span class="text-lg tracking-wide">{{ item.company }}</span>
                 </div>
              </div>
              
              <div class="flex flex-col items-end gap-3">
                 <span class="px-4 py-1.5 rounded-full text-xs sm:text-sm font-mono font-medium bg-zinc-100 dark:bg-zinc-800/50 text-zinc-500 dark:text-zinc-400 border border-zinc-200 dark:border-zinc-700/50 backdrop-blur-md">
                   {{ item.date }}
                 </span>
                 @if (item.current) {
                   <span class="flex items-center gap-2 px-3 py-1 rounded-full bg-green-500/10 text-[10px] sm:text-xs font-bold text-green-600 dark:text-green-400 border border-green-500/20 shadow-sm shadow-green-500/10">
                     <span class="relative flex h-2 w-2">
                       <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                       <span class="relative inline-flex rounded-full h-2 w-2 bg-green-500"></span>
                     </span>
                     ACTIVE
                   </span>
                 }
              </div>
            </div>

            <!-- Description -->
            <div class="flex-grow">
               <ul class="space-y-4">
                  @for (desc of item.description; track $index) {
                     <li class="flex items-start gap-3 text-zinc-600 dark:text-zinc-400 text-sm sm:text-base leading-relaxed">
                        <span class="mt-2.5 w-1.5 h-1.5 flex-shrink-0 rounded-full bg-zinc-300 dark:bg-zinc-600 group-hover:bg-blue-500 group-hover:shadow-[0_0_8px_rgba(59,130,246,0.5)] transition-all duration-300"></span>
                        <span>{{ desc }}</span>
                     </li>
                  }
               </ul>
            </div>

            <!-- Skills -->
            @if(item.skills && item.skills!.length > 0){
              <div class="mt-8 pt-6 border-t border-zinc-200/50 dark:border-zinc-700/30">
                 <div class="flex flex-wrap gap-2">
                    @for (skill of item.skills; track $index) {
                       <span 
                         class="px-3 py-1.5 text-xs font-semibold tracking-wide rounded-lg bg-zinc-50 dark:bg-zinc-800/50 border border-zinc-200/50 dark:border-zinc-700/50 text-zinc-500 dark:text-zinc-400 transition-all duration-300 group-hover:border-blue-500/30 group-hover:bg-blue-50/50 dark:group-hover:bg-blue-900/20 group-hover:text-blue-600 dark:group-hover:text-blue-300"
                       >
                          {{ skill }}
                       </span>
                    }
                 </div>
              </div>
            }
          </div>
        </div>
      }
      
      <!-- End spacer for scroll completion -->
      <div class="flex-shrink-0 w-[20vw]"></div>
    </div>

    <!-- Progress indicator -->
    <div class="absolute bottom-4 left-1/2 -translate-x-1/2 flex items-center gap-2">
      <span class="text-xs text-zinc-400 font-mono">Scroll</span>
      <div class="w-20 h-1 bg-zinc-200 dark:bg-zinc-800 rounded-full overflow-hidden">
        <div #progressBar class="h-full bg-gradient-to-r from-blue-500 to-purple-500 rounded-full w-0"></div>
      </div>
    </div>
  </div>
</section>